# ุฅุตูุงุญ ุฒุฑ ุงูุนูุฏุฉ ูู ุตูุญุฉ AuthPage

**ุงูุชุงุฑูุฎ**: 2026-02-17  
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ

---

## ๐ ุงููุดููุฉ

ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู ุงููุงุชู ุฃุซูุงุก ุงูุชูุงุฌุฏ ูู ุตูุญุฉ AuthPage (`/auth`):
- โ ุงูุชุทุจูู ูุง ูุณุชุฌูุจ ููุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ
- โ ูุจูู ูู ููุณ ุงูุตูุญุฉ ููุฃู ุงูุฒุฑ ูุนุทู ุชูุงูุงู
- โ ูุง ูุฑุฌุน ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ููุง ูู ูุชููุน

### ุงูุณููู ุงููุชููุน:
1. โ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู `/auth` โ ุงูุฑุฌูุน ูุตูุญุฉ `/login`
2. โ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู `/login` โ ุนุฑุถ ุฑุณุงูุฉ ุชุฃููุฏ ุงูุฎุฑูุฌ ุงูููุงุฆู

---

## ๐ ุงูุชุดุฎูุต

### ุงูุณุจุจ ุงูุฌุฐุฑู:

1. **ุตูุญุฉ `/auth` ุบูุฑ ูุฏุฑุฌุฉ ูู ุงููุธุงู**:
   - ุตูุญุฉ AuthPage ูู ุชูู ูู ูุงุฆูุฉ `exitPages` ูู `useExitConfirm.js`
   - ูู ุชูู ูู ูุงุฆูุฉ ุงูุตูุญุงุช ุงูุชู ูุฌุจ ูุนุงูุฌุชูุง ุจุดูู ุฎุงุต

2. **ุชุนุงุฑุถ ูู `MainActivity.java`**:
   - ุงูููุฏ ุงูุญุงูู ูู `MainActivity.java` ูุงู ูููุน ุงูุณููู ุงูุงูุชุฑุงุถู ุชูุงูุงู
   - ุนูุฏ ุนุฏู ูุฌูุฏ ูุนุงูุฌุฉ ุฎุงุตุฉ ูู JavaScriptุ ูุง ูุญุฏุซ ุดูุก

3. **ููุทู ุบูุฑ ููุชูู**:
   - ุงููุธุงู ูุงู ูุชุนุงูู ูุน ููุนูู ูู ุงูุตูุญุงุช ููุท:
     - ุตูุญุงุช ุฎุฑูุฌ (ุชุนุฑุถ ุฑุณุงูุฉ ุชุฃููุฏ)
     - ุตูุญุงุช ุนุงุฏูุฉ (ุชุฑุฌุน ููุตูุญุฉ ุงูุณุงุจูุฉ)
   - ูู ููู ููุงู ูุนุงูุฌุฉ ูุตูุญุงุช ูุซู AuthPage ุงูุชู ูุฌุจ ุฃู ุชุฑุฌุน ุฏุงุฆูุงู ููุตูุญุฉ ุงูุณุงุจูุฉ

---

## โ ุงูุญู ุงููุทุจู

### 1. ุฅุถุงูุฉ ูุงุฆูุฉ `backPages` ูู useExitConfirm.js

ุชู ุฅูุดุงุก ูุงุฆูุฉ ุฌุฏูุฏุฉ ููุตูุญุงุช ุงูุชู ูุฌุจ ุงูุฑุฌูุน ูููุง ููุตูุญุฉ ุงูุณุงุจูุฉ ุจุฏูู ุชุฃููุฏ:

```javascript
// โ ุตูุญุงุช ูุฌุจ ุงูุฑุฌูุน ูููุง ููุตูุญุฉ ุงูุณุงุจูุฉ (ุจุฏูู ุชุฃููุฏ ุฎุฑูุฌ)
const backPages = [
  '/auth' // ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู AuthPageุ ูุฑุฌุน ูุตูุญุฉ Login
];
```

### 2. ุฅุถุงูุฉ ุฏุงูุฉ `isBackPage()`

```javascript
// ุงูุชุญูู ูู ุฃููุง ูู ุตูุญุฉ ูุฌุจ ุงูุฑุฌูุน ูููุง
const isBackPage = useCallback(() => {
  return backPages.some(page => location.pathname === page || location.pathname.startsWith(page));
}, [location.pathname]);
```

### 3. ุชุญุฏูุซ ููุทู ูุนุงูุฌุฉ ุฒุฑ ุงูุนูุฏุฉ

ุชู ุชุนุฏูู `handleBackButton` ูุฅุนุทุงุก ุงูุฃููููุฉ ูุตูุญุงุช ุงูุฑุฌูุน:

```javascript
const handleBackButton = (event) => {
  // ููุน ุงูุชูููุฐ ุงููุชุนุฏุฏ
  if (isHandlingBack.current) {
    console.log('โณ Already handling back button, ignoring...');
    return;
  }

  isHandlingBack.current = true;
  console.log('๐ Back button pressed, canGoBack:', event.canGoBack, 'current path:', location.pathname);

  // โ ุงูุฃููููุฉ ุงูุฃููู: ุตูุญุงุช ุงูุฑุฌูุน (ูุซู /auth)
  if (isBackPage()) {
    console.log('โฌ๏ธ On back page, navigating to previous page');
    navigate(-1);
    setTimeout(() => {
      isHandlingBack.current = false;
    }, 300);
  }
  // ุงูุฃููููุฉ ุงูุซุงููุฉ: ุตูุญุงุช ุงูุฎุฑูุฌ (ุชุนุฑุถ ุฑุณุงูุฉ ุชุฃููุฏ)
  else if (isExitPage()) {
    console.log('๐ On exit page, showing confirmation modal');
    setShowExitModal(true);
    setTimeout(() => {
      isHandlingBack.current = false;
    }, 300);
  }
  // ุงูุฃููููุฉ ุงูุซุงูุซุฉ: ุตูุญุงุช ุนุงุฏูุฉ (ุชุฑุฌุน ุฅุฐุง ูุงู ููููุงู)
  else if (event.canGoBack) {
    console.log('โฌ๏ธ Going back to previous page');
    navigate(-1);
    setTimeout(() => {
      isHandlingBack.current = false;
    }, 300);
  }
  // ุงูุฃููููุฉ ุงูุฃุฎูุฑุฉ: ูุง ููุฌุฏ ุตูุญุฉ ุณุงุจูุฉ (ุนุฑุถ ุฑุณุงูุฉ ุฎุฑูุฌ)
  else {
    console.log('๐ช No previous page, showing exit confirmation');
    setShowExitModal(true);
    setTimeout(() => {
      isHandlingBack.current = false;
    }, 300);
  }
};
```

---

## ๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู 1: ุงููุณุชุฎุฏู ูู ุตูุญุฉ AuthPage
```
1. ุงููุณุชุฎุฏู ูู ุตูุญุฉ /auth (ุงูุชุณุฌูู)
2. ูุถุบุท ุฒุฑ ุงูุนูุฏุฉ ูู ุงููุงุชู
3. โ ูุฑุฌุน ูุจุงุดุฑุฉ ูุตูุญุฉ /login (ุจุฏูู ุฑุณุงูุฉ ุชุฃููุฏ)
```

### ุงูุณููุงุฑูู 2: ุงููุณุชุฎุฏู ูู ุตูุญุฉ LoginPage
```
1. ุงููุณุชุฎุฏู ูู ุตูุญุฉ /login
2. ูุถุบุท ุฒุฑ ุงูุนูุฏุฉ ูู ุงููุงุชู
3. โ ุชุธูุฑ ุฑุณุงูุฉ: "ูู ุญูุงู ุชุฑูุฏ ุงูุฎุฑูุฌ ูู ุงูุชุทุจููุ"
4. ูุฎุชุงุฑ "ูุนู" โ ุงูุชุทุจูู ููุบูู
5. ูุฎุชุงุฑ "ูุง" โ ูุจูู ูู ุตูุญุฉ Login
```

### ุงูุณููุงุฑูู 3: ุงููุณุชุฎุฏู ูู ุตูุญุฉ ุฏุงุฎููุฉ
```
1. ุงููุณุชุฎุฏู ูู ุตูุญุฉ Settings (ูุซูุงู)
2. ูุถุบุท ุฒุฑ ุงูุนูุฏุฉ ูู ุงููุงุชู
3. โ ูุฑุฌุน ููุตูุญุฉ ุงูุณุงุจูุฉ (ุจุฏูู ุฑุณุงูุฉ ุชุฃููุฏ)
```

---

## ๐ฏ ููุทู ุงููุธุงู ุงููุงูู

### ุฃููุงุน ุงูุตูุญุงุช ูู ุงูุชุทุจูู:

1. **ุตูุญุงุช ุงูุฎุฑูุฌ (Exit Pages)**:
   ```javascript
   ['/login', '/entry', '/admin-dashboard', '/profile', ...]
   ```
   - ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ: ุชุธูุฑ ุฑุณุงูุฉ ุชุฃููุฏ ุงูุฎุฑูุฌ
   - ูุฐู ุตูุญุงุช ุฑุฆูุณูุฉ ูุง ูุฌุจ ุงูุฎุฑูุฌ ูููุง ุจุณูููุฉ

2. **ุตูุญุงุช ุงูุฑุฌูุน (Back Pages)** - ุฌุฏูุฏ:
   ```javascript
   ['/auth']
   ```
   - ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ: ุงูุฑุฌูุน ููุตูุญุฉ ุงูุณุงุจูุฉ ูุจุงุดุฑุฉ
   - ูุฐู ุตูุญุงุช ุซุงูููุฉ ูุฌุจ ุฃู ูุณูู ุงูุฑุฌูุน ูููุง

3. **ุตูุญุงุช ุนุงุฏูุฉ**:
   - ุฃู ุตูุญุฉ ุฃุฎุฑู ุบูุฑ ูุฏุฑุฌุฉ ูู ุงููุงุฆูุชูู
   - ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ: ุงูุฑุฌูุน ููุตูุญุฉ ุงูุณุงุจูุฉ ุฅุฐุง ูุงู ููููุงู

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### 1. frontend/src/hooks/useExitConfirm.js

**ุงูุชุบููุฑุงุช**:
- โ ุฅุถุงูุฉ ูุงุฆูุฉ `backPages`
- โ ุฅุถุงูุฉ ุฏุงูุฉ `isBackPage()`
- โ ุชุญุฏูุซ ููุทู `handleBackButton` ูุฅุนุทุงุก ุงูุฃููููุฉ ูุตูุญุงุช ุงูุฑุฌูุน

**ุงูููุฏ ุงููุถุงู**:
```javascript
// โ ุตูุญุงุช ูุฌุจ ุงูุฑุฌูุน ูููุง ููุตูุญุฉ ุงูุณุงุจูุฉ (ุจุฏูู ุชุฃููุฏ ุฎุฑูุฌ)
const backPages = [
  '/auth' // ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู AuthPageุ ูุฑุฌุน ูุตูุญุฉ Login
];

// ุงูุชุญูู ูู ุฃููุง ูู ุตูุญุฉ ูุฌุจ ุงูุฑุฌูุน ูููุง
const isBackPage = useCallback(() => {
  return backPages.some(page => location.pathname === page || location.pathname.startsWith(page));
}, [location.pathname]);
```

### 2. frontend/android/app/src/main/java/com/careerak/app/MainActivity.java

**ูุง ุชุบููุฑ** - ุงูููุฏ ุงูุญุงูู ุตุญูุญ ููุนูู ุจุดูู ุฌูุฏ:
```java
@Override
public void onBackPressed() {
    Log.d(TAG, "Back button pressed - delegating to Capacitor bridge");
    super.onBackPressed();
}
```

---

## ๐งช ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### ุนูู ุงููุงุชู ุงููุนูู:

#### ุงุฎุชุจุงุฑ 1: ุงูุฑุฌูุน ูู AuthPage ุฅูู LoginPage
```
1. โ ุงูุชุญ ุงูุชุทุจูู ุนูู ุงููุงุชู
2. โ ุงุฐูุจ ุฅูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู (/login)
3. โ ุงุถุบุท ุนูู "ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ" ููุงูุชูุงู ุฅูู /auth
4. โ ุงุถุบุท ุฒุฑ ุงูุนูุฏุฉ ูู ุงููุงุชู
5. โ ูุฌุจ ุฃู ูุฑุฌุน ูุจุงุดุฑุฉ ูุตูุญุฉ /login (ุจุฏูู ุฑุณุงูุฉ ุชุฃููุฏ)
```

#### ุงุฎุชุจุงุฑ 2: ุชุฃููุฏ ุงูุฎุฑูุฌ ูู LoginPage
```
1. โ ุงูุชุญ ุงูุชุทุจูู
2. โ ูู ุตูุญุฉ /loginุ ุงุถุบุท ุฒุฑ ุงูุนูุฏุฉ
3. โ ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ: "ูู ุญูุงู ุชุฑูุฏ ุงูุฎุฑูุฌ ูู ุงูุชุทุจููุ"
4. โ ุงุถุบุท "ูุง" โ ุงูุฑุณุงูุฉ ุชูุบููุ ุชุจูู ูู /login
5. โ ุงุถุบุท ุฒุฑ ุงูุนูุฏุฉ ูุฑุฉ ุฃุฎุฑูุ ุงุถุบุท "ูุนู" โ ุงูุชุทุจูู ููุบูู
```

#### ุงุฎุชุจุงุฑ 3: ุงูุชููู ุงูุนุงุฏู
```
1. โ ุณุฌู ุฏุฎูู ูุงุฐูุจ ูุฃู ุตูุญุฉ ุฏุงุฎููุฉ
2. โ ุงุถุบุท ุฒุฑ ุงูุนูุฏุฉ
3. โ ูุฌุจ ุฃู ูุฑุฌุน ููุตูุญุฉ ุงูุณุงุจูุฉ ุจุดูู ุทุจูุนู
```

### Console Logs ุงููุชููุนุฉ:

#### ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู /auth:
```
๐ Back button pressed, canGoBack: true, current path: /auth
โฌ๏ธ On back page, navigating to previous page
```

#### ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุนูุฏุฉ ูู /login:
```
๐ Back button pressed, canGoBack: false, current path: /login
๐ On exit page, showing confirmation modal
```

---

## ๐ก ุฅุถุงูุฉ ุตูุญุงุช ุฌุฏูุฏุฉ

### ูุฅุถุงูุฉ ุตูุญุฉ ุฌุฏูุฏุฉ ููุงุฆูุฉ "ุตูุญุงุช ุงูุฑุฌูุน":

```javascript
// ูู useExitConfirm.js
const backPages = [
  '/auth',
  '/your-new-page', // โ ุฃุถู ุตูุญุชู ููุง
];
```

### ูุฅุถุงูุฉ ุตูุญุฉ ุฌุฏูุฏุฉ ููุงุฆูุฉ "ุตูุญุงุช ุงูุฎุฑูุฌ":

```javascript
// ูู useExitConfirm.js
const exitPages = [
  '/login',
  '/entry',
  // ... ุงูุตูุญุงุช ุงูููุฌูุฏุฉ
  '/your-exit-page', // โ ุฃุถู ุตูุญุชู ููุง
];
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ูุดููุฉ ุฒุฑ ุงูุนูุฏุฉ ูู ุตูุญุฉ AuthPage ุจุฅุถุงูุฉ ูุธุงู ุฌุฏูุฏ ูุชุตููู ุงูุตูุญุงุช:

- โ **ุตูุญุงุช ุงูุฑุฌูุน (Back Pages)**: ุชุฑุฌุน ููุตูุญุฉ ุงูุณุงุจูุฉ ูุจุงุดุฑุฉ
- โ **ุตูุญุงุช ุงูุฎุฑูุฌ (Exit Pages)**: ุชุนุฑุถ ุฑุณุงูุฉ ุชุฃููุฏ ุงูุฎุฑูุฌ
- โ **ุตูุญุงุช ุนุงุฏูุฉ**: ุชุชุจุน ุงูุณููู ุงูุงูุชุฑุงุถู

ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุงูู ูููุทูู:
- `/auth` โ `/login` (ุฑุฌูุน ูุจุงุดุฑ)
- `/login` โ ุฑุณุงูุฉ ุชุฃููุฏ ุงูุฎุฑูุฌ
- ุตูุญุงุช ุฃุฎุฑู โ ุฑุฌูุน ุนุงุฏู

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2026-02-17  
**ุงููุทูุฑ**: Eng.AlaaUddien  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ ุนูู ุงููุงุชู ุงููุนูู
