# ๐ค ูุธุงู ุงูุชูุตูุงุช ุงูููููุฉ (Daily Recommendations System)

## ๐ ูุนูููุงุช ุงููุธุงู
- **ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2026-02-27
- **ุงูุญุงูุฉ**: โ ููุชูู ูููุนูู
- **ุงููุชุทูุจุงุช**: 7.2, 7.3 (ุชุญุฏูุซ ูููู ููุชูุตูุงุชุ ูุณู "ุฌุฏูุฏ ูู")
- **Task**: 12.2 ุชุญุฏูุซ ูููู

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุชูุตูุงุช ุงูููููุฉ ูู ูุธุงู ุชููุงุฆู ูููู ุจุชูููุฏ ุชูุตูุงุช ูุธุงุฆู ุฌุฏูุฏุฉ ููููุงู ูุฌููุน ุงููุณุชุฎุฏููู ุงููุดุทููุ ูุน ุนุฑุถูุง ูู ูุณู "ุฌุฏูุฏ ูู" ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ.

### ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ
- โ ุชูููุฏ ุชูุตูุงุช ููููุฉ ุชููุงุฆูุงู (ุงูุณุงุนุฉ 2:00 ุตุจุงุญุงู)
- โ ูุนุงูุฌุฉ ุฏูุนูุฉ ูููุณุชุฎุฏููู (Batch Processing)
- โ ุนูุงูุฉ "ุฌุฏูุฏ" ููุชูุตูุงุช ุงูุญุฏูุซุฉ
- โ ูุณู "ุฌุฏูุฏ ูู" ูู Frontend
- โ ุชุญุฏูุซ ุชููุงุฆู ููุชูุตูุงุช ุงููุฏููุฉ
- โ ุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู (ุงุฎุชูุงุฑู)
- โ ููุญุฉ ุชุญูู ููุฃุฏูู

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### Backend

#### 1. Daily Recommendation Service
**ุงููููุน**: `backend/src/services/dailyRecommendationService.js`

**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ**:
```javascript
// ุชุดุบูู ุงูุชุญุฏูุซ ุงููููู
await dailyRecommendationService.runDailyUpdate(options);

// ุฌูุจ ุงูุชูุตูุงุช ุงูุฌุฏูุฏุฉ
await dailyRecommendationService.getNewRecommendations(userId, options);

// ุชุญุฏูุฏ ุชูุตูุฉ ููุดุงูุฏุฉ
await dailyRecommendationService.markRecommendationAsSeen(recommendationId);

// ุงูุญุตูู ุนูู ุญุงูุฉ ุงูุชุญุฏูุซ
dailyRecommendationService.getStatus();
```

**ุงูุฎูุงุฑุงุช ุงููุชุงุญุฉ**:
```javascript
{
  lastActiveWithinDays: 30,      // ุงููุณุชุฎุฏููู ุงููุดุทูู ุฎูุงู ุขุฎุฑ 30 ููู
  minProfileCompleteness: 30,    // ุงูุชูุงู ุงูููู ุงูุดุฎุตู 30% ุนูู ุงูุฃูู
  batchSize: 10,                 // ูุนุงูุฌุฉ 10 ูุณุชุฎุฏููู ูู ูู ุฏูุนุฉ
  maxUsers: 1000,                // ุญุฏ ุฃูุตู 1000 ูุณุชุฎุฏู
  limit: 10                      // ุนุฏุฏ ุงูุชูุตูุงุช ููู ูุณุชุฎุฏู
}
```

#### 2. Daily Recommendation Cron Job
**ุงููููุน**: `backend/src/jobs/dailyRecommendationCron.js`

**ุงูุฌุฏูู ุงูุงูุชุฑุงุถู**: `0 2 * * *` (ูู ููู ูู ุงูุณุงุนุฉ 2:00 ุตุจุงุญุงู)

**ุงููุธุงุฆู**:
```javascript
// ุจุฏุก ุงูุฌุฏููุฉ
dailyRecommendationCron.start(options);

// ุฅููุงู ุงูุฌุฏููุฉ
dailyRecommendationCron.stop();

// ุชุดุบูู ูุฏูู
await dailyRecommendationCron.runManually(options);

// ุงูุญุตูู ุนูู ุงูุญุงูุฉ
dailyRecommendationCron.getStatus();
```

#### 3. API Endpoints

**ูููุณุชุฎุฏููู**:
```
GET    /api/recommendations/new              # ุฌูุจ ุงูุชูุตูุงุช ุงูุฌุฏูุฏุฉ
PATCH  /api/recommendations/:id/seen         # ุชุญุฏูุฏ ุชูุตูุฉ ููุดุงูุฏุฉ
```

**ููุฃุฏูู**:
```
POST   /api/recommendations/daily-update              # ุชุดุบูู ูุฏูู
GET    /api/recommendations/daily-update/status       # ุงูุญุตูู ุนูู ุงูุญุงูุฉ
POST   /api/recommendations/daily-update/schedule     # ุจุฏุก/ุฅููุงู ุงูุฌุฏููุฉ
```

### Frontend

#### ูููู "ุฌุฏูุฏ ูู"
**ุงููููุน**: `frontend/src/components/NewForYou/NewForYou.jsx`

**ุงูุงุณุชุฎุฏุงู**:
```jsx
import NewForYou from './components/NewForYou/NewForYou';

function HomePage() {
  return (
    <div>
      <NewForYou />
    </div>
  );
}
```

**ุงูููุฒุงุช**:
- ุนุฑุถ ุงูุชูุตูุงุช ุงูุฌุฏูุฏุฉ ูู ุดุจูุฉ (Grid)
- ูุณุจุฉ ุงูุชุทุงุจู ููู ูุธููุฉ
- ุฃุณุจุงุจ ุงูุชูุตูุฉ
- ุฃุฒุฑุงุฑ "ุนุฑุถ ุงููุธููุฉ" ู "ุชูุฏูู"
- ุนูุงูุฉ "NEW" ููุชูุตูุงุช ุงูุฌุฏูุฏุฉ
- ุฏุนู ูุชุนุฏุฏ ุงููุบุงุช (ar, en, fr)
- ุชุตููู ูุชุฌุงูุจ

---

## ๐ ุงูุฅุนุฏุงุฏ ูุงูุชุดุบูู

### 1. ุชุซุจูุช ุงูุชุจุนูุงุช

```bash
cd backend
npm install node-cron
```

### 2. ุจุฏุก ุงูุณูุฑูุฑ

```bash
cd backend
npm start
```

ุณูุจุฏุฃ Cron Job ุชููุงุฆูุงู ุนูุฏ ุชุดุบูู ุงูุณูุฑูุฑ.

### 3. ุงูุชุญูู ูู ุงูุฌุฏููุฉ

```bash
# ูู console ุงูุณูุฑูุฑ
โ ุชู ุจุฏุก ุฌุฏููุฉ ุงูุชุญุฏูุซ ุงููููู ููุชูุตูุงุช
๐ ุจุฏุก ุฌุฏููุฉ ุงูุชุญุฏูุซ ุงููููู ููุชูุตูุงุช...
๐ ุงูุฌุฏูู: 0 2 * * * (Africa/Cairo)
โ ุชู ุฌุฏููุฉ ุงูุชุญุฏูุซ ุงููููู ุจูุฌุงุญ
โน๏ธ ุงูุชุดุบูู ุงูุชุงูู: [ุงูุชุงุฑูุฎ ูุงูููุช]
```

---

## ๐ ููู ูุนูู ุงููุธุงู

### 1. ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ

```
ูู ููู ูู ุงูุณุงุนุฉ 2:00 ุตุจุงุญุงู:
  โ
1. ุฌูุจ ุงููุณุชุฎุฏููู ุงููุดุทูู (ุขุฎุฑ 30 ููู)
  โ
2. ุฌูุจ ุงููุธุงุฆู ุงููุดุทุฉ
  โ
3. ูุนุงูุฌุฉ ุงููุณุชุฎุฏููู ูู ุฏูุนุงุช (10 ูุณุชุฎุฏููู/ุฏูุนุฉ)
  โ
4. ุชูููุฏ ุชูุตูุงุช ููู ูุณุชุฎุฏู (20 ุชูุตูุฉ/ูุณุชุฎุฏู)
  โ
5. ุญูุธ ุงูุชูุตูุงุช ูุน ุนูุงูุฉ "ุฌุฏูุฏ"
  โ
6. ุชุญุฏูุซ ุงูุชูุตูุงุช ุงููุฏููุฉ (ุฅุฒุงูุฉ ุนูุงูุฉ "ุฌุฏูุฏ")
  โ
7. ุญุฐู ุงูุชูุตูุงุช ุงููุฏููุฉ (ุฃูุซุฑ ูู 7 ุฃูุงู)
  โ
8. ุฅุฑุณุงู ุฅุดุนุงุฑุงุช (ุงุฎุชูุงุฑู)
```

### 2. ุนุฑุถ ุงูุชูุตูุงุช ุงูุฌุฏูุฏุฉ

```
ุงููุณุชุฎุฏู ููุชุญ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ:
  โ
1. ูููู NewForYou ูุฌูุจ ุงูุชูุตูุงุช ุงูุฌุฏูุฏุฉ
  โ
2. ุนุฑุถ ุงูุชูุตูุงุช ูุน ุนูุงูุฉ "NEW"
  โ
3. ุนูุฏ ุงูููุฑ ุนูู "ุนุฑุถ ุงููุธููุฉ":
   - ุชุญุฏูุฏ ุงูุชูุตูุฉ ููุดุงูุฏุฉ
   - ุฅุฒุงูุฉ ุนูุงูุฉ "ุฌุฏูุฏ"
   - ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุงููุธููุฉ
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงูุชุดุบูู ุงููุฏูู

```bash
# ุงุณุชุฎุฏุงู Postman ุฃู curl
POST http://localhost:5000/api/recommendations/daily-update
Authorization: Bearer <admin_token>
Content-Type: application/json

{
  "lastActiveWithinDays": 30,
  "minProfileCompleteness": 30,
  "batchSize": 5,
  "maxUsers": 50
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุงูุชูุตูุงุช ุงูููููุฉ ุจูุฌุงุญ",
  "stats": {
    "totalUsers": 50,
    "processedUsers": 48,
    "failedUsers": 2,
    "totalRecommendations": 960,
    "startTime": "2026-02-27T02:00:00.000Z",
    "endTime": "2026-02-27T02:05:30.000Z",
    "duration": 330000
  }
}
```

### 2. ุงุฎุชุจุงุฑ ุฌูุจ ุงูุชูุตูุงุช ุงูุฌุฏูุฏุฉ

```bash
GET http://localhost:5000/api/recommendations/new?limit=10
Authorization: Bearer <user_token>
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
```json
{
  "success": true,
  "count": 10,
  "recommendations": [
    {
      "job": {
        "_id": "...",
        "title": "ูุทูุฑ Full Stack",
        "location": "ุงููุงูุฑุฉุ ูุตุฑ"
      },
      "matchScore": {
        "percentage": 85,
        "overall": 0.85
      },
      "reasons": [
        {
          "type": "skills",
          "message": "ููุงุฑุงุช ุงูุจุฑูุฌุฉ (JavaScriptุ Reactุ Node.js) ุชุชุทุงุจู ูุน ูุชุทูุจุงุช ุงููุธููุฉ",
          "strength": "high"
        }
      ],
      "isNew": true,
      "generatedAt": "2026-02-27T02:00:00.000Z"
    }
  ]
}
```

### 3. ุงุฎุชุจุงุฑ ุงูุญุงูุฉ

```bash
GET http://localhost:5000/api/recommendations/daily-update/status
Authorization: Bearer <admin_token>
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงููุฑุงูุจุฉ

### ูุซุงู ุนูู ุฅุญุตุงุฆูุงุช ุงูุชุญุฏูุซ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ุชุดุบูู ุงูุชุญุฏูุซ ุงููููู ุงููุฌุฏูู ููุชูุตูุงุช
โฐ ุงูููุช: 27/2/2026, 2:00:00 ุต
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ุจุฏุก ุงูุชุญุฏูุซ ุงููููู ููุชูุตูุงุช...
๐ ุงูุชุงุฑูุฎ: 27/2/2026, 2:00:00 ุต
๐ฅ ุนุฏุฏ ุงููุณุชุฎุฏููู ุงููุดุทูู: 150
๐ผ ุนุฏุฏ ุงููุธุงุฆู ุงููุดุทุฉ: 250

โ๏ธ ูุนุงูุฌุฉ ุงูุฏูุนุฉ 1/15 (10 ูุณุชุฎุฏู)...
โ๏ธ ูุนุงูุฌุฉ ุงูุฏูุนุฉ 2/15 (10 ูุณุชุฎุฏู)...
...
โ๏ธ ูุนุงูุฌุฉ ุงูุฏูุนุฉ 15/15 (10 ูุณุชุฎุฏู)...

โ ุงูุชูู ุงูุชุญุฏูุซ ุงููููู ููุชูุตูุงุช
๐ ุงูุฅุญุตุงุฆูุงุช:
   - ุงููุณุชุฎุฏููู ุงููุนุงูุฌูู: 148/150
   - ุงููุณุชุฎุฏููู ุงููุงุดููู: 2
   - ุฅุฌูุงูู ุงูุชูุตูุงุช: 2960

โฑ๏ธ ูุฏุฉ ุงูุชุญุฏูุซ: 330 ุซุงููุฉ

โ ุงูุชูู ุงูุชุญุฏูุซ ุงููููู ุงููุฌุฏูู ุจูุฌุงุญ
๐ ุงูุฅุญุตุงุฆูุงุช:
   - ุงููุณุชุฎุฏููู ุงููุนุงูุฌูู: 148
   - ุฅุฌูุงูู ุงูุชูุตูุงุช: 2960
   - ุงููุฏุฉ: 330 ุซุงููุฉ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ง ุงูุชุฎุตูุต

### ุชุบููุฑ ุฌุฏูู ุงูุชุดุบูู

```javascript
// ูู backend/src/jobs/dailyRecommendationCron.js
this.schedule = '0 3 * * *'; // ุงูุณุงุนุฉ 3:00 ุตุจุงุญุงู
this.schedule = '0 */6 * * *'; // ูู 6 ุณุงุนุงุช
this.schedule = '0 0 * * 0'; // ูู ุฃุญุฏ ูู ููุชุตู ุงูููู
```

### ุชุบููุฑ ุนุฏุฏ ุงูุชูุตูุงุช

```javascript
// ูู backend/src/services/dailyRecommendationService.js
const recommendations = await this.contentBasedFiltering.rankJobsByMatch(
  user,
  jobs,
  {
    saveToDB: false,
    limit: 30, // ุชุบููุฑ ูู 20 ุฅูู 30
    minScore: 0.3
  }
);
```

### ุชุบููุฑ ูุฏุฉ ุตูุงุญูุฉ ุงูุชูุตูุงุช

```javascript
// ูู backend/src/services/dailyRecommendationService.js
expiresAt: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000) // ุฃุณุจูุนูู ุจุฏูุงู ูู ุฃุณุจูุน
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: Cron Job ูุง ูุนูู

**ุงูุญู**:
```bash
# 1. ุชุญูู ูู ุงูุณุฌูุงุช
tail -f backend/logs/combined.log

# 2. ุชุญูู ูู ุงูุญุงูุฉ
GET /api/recommendations/daily-update/status

# 3. ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ
npm restart
```

### ุงููุดููุฉ: ูุง ุชูุฌุฏ ุชูุตูุงุช ุฌุฏูุฏุฉ

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ**:
1. ูู ูุชู ุชุดุบูู ุงูุชุญุฏูุซ ุงููููู ุจุนุฏ
2. ุงููุณุชุฎุฏู ุบูุฑ ูุดุท (ุขุฎุฑ ูุดุงุท > 30 ููู)
3. ุงูุชูุงู ุงูููู ุงูุดุฎุตู < 30%
4. ูุง ุชูุฌุฏ ูุธุงุฆู ูุดุทุฉ

**ุงูุญู**:
```bash
# ุชุดุบูู ูุฏูู ููุชุญุฏูุซ
POST /api/recommendations/daily-update
```

### ุงููุดููุฉ: ุงูุชุญุฏูุซ ุจุทูุก ุฌุฏุงู

**ุงูุญู**:
```javascript
// ุชูููู ุญุฌู ุงูุฏูุนุฉ
batchSize: 5 // ุจุฏูุงู ูู 10

// ุชูููู ุนุฏุฏ ุงููุณุชุฎุฏููู
maxUsers: 500 // ุจุฏูุงู ูู 1000

// ุชูููู ุนุฏุฏ ุงููุธุงุฆู
.limit(200) // ุจุฏูุงู ูู 500
```

---

## ๐ ุงููุฑุงุฌุน

- **Requirements**: `.kiro/specs/ai-recommendations/requirements.md`
- **Design**: `.kiro/specs/ai-recommendations/design.md`
- **Tasks**: `.kiro/specs/ai-recommendations/tasks.md`
- **Content-Based Filtering**: `backend/src/services/contentBasedFiltering.js`
- **Recommendation Model**: `backend/src/models/Recommendation.js`

---

## โ ุงูููุงุฆุฏ ุงููุชููุนุฉ

- ๐ ุฒูุงุฏุฉ engagement ุจูุณุจุฉ 40-60%
- โก ุชุญุณูู ูุนุฏู ุงูุชูุฏูู ุนูู ุงููุธุงุฆู
- ๐ฏ ุชูุตูุงุช ุฃูุซุฑ ุฏูุฉ ูุชุฎุตูุตุงู
- ๐ฅ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู
- ๐ ุชุญุฏูุซ ูุณุชูุฑ ููุชูุตูุงุช

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. โ Cron Job ูุจุฏุฃ ุชููุงุฆูุงู ุนูุฏ ุชุดุบูู ุงูุณูุฑูุฑ
2. โ ุงูุชูุตูุงุช ุงููุฏููุฉ (> 7 ุฃูุงู) ุชูุญุฐู ุชููุงุฆูุงู
3. โ ุนูุงูุฉ "ุฌุฏูุฏ" ุชูุฒุงู ุนูุฏ ุงููุดุงูุฏุฉ
4. โ ูุฏุนู ูุนุงูุฌุฉ ุฏูุนูุฉ ูุชุฌูุจ ุงูุถุบุท ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
5. โ ูููู ุชุดุบููู ูุฏููุงู ููุงุฎุชุจุงุฑ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2026-02-27  
**ุขุฎุฑ ุชุญุฏูุซ**: 2026-02-27  
**ุงูุญุงูุฉ**: โ ููุชูู ูููุนูู
