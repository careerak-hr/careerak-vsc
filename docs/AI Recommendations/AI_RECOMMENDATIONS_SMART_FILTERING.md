# ๐ ููุชุฑุฉ ุฐููุฉ ูููุฑุดุญูู - Smart Candidate Filtering

## ูุนูููุงุช ุงูููุฒุฉ
- **ุชุงุฑูุฎ ุงูุฅุถุงูุฉ**: 2026-02-26
- **ุงูุญุงูุฉ**: โ ููุชูู ูููุนูู
- **ุงููุชุทูุจุงุช**: Requirements 3.6 (ููุชุฑุฉ ุฐููุฉ - ุฎุจุฑุฉุ ููุงุฑุงุชุ ูููุน)

## ูุธุฑุฉ ุนุงูุฉ
ูุธุงู ููุชุฑุฉ ุฐูู ูููุฑุดุญูู ูุณูุญ ููุดุฑูุงุช ุจุงูุจุญุซ ุนู ุงููุฑุดุญูู ุงูููุงุณุจูู ุจูุงุกู ุนูู ูุนุงููุฑ ูุชุนุฏุฏุฉ:
- ุงูููุงุฑุงุช ุงูุชูููุฉ ูุงูุจุฑูุฌูุฉ
- ุณููุงุช ุงูุฎุจุฑุฉ (ุญุฏ ุฃุฏูู ูุฃูุตู)
- ุงููููุน ุงูุฌุบุฑุงูู (ูุฏููุฉ ุฃู ุฏููุฉ)
- ุงููุณุชูู ุงูุชุนูููู
- ุฏุฑุฌุฉ ุงูุชุทุงุจู ูุน ูุธููุฉ ูุญุฏุฏุฉ

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ููุชุฑุฉ ูุชุนุฏุฏุฉ ุงููุนุงููุฑ
- โ ููุชุฑุฉ ุญุณุจ ุงูููุงุฑุงุช (skills)
- โ ููุชุฑุฉ ุญุณุจ ุงูุฎุจุฑุฉ (minExperience, maxExperience)
- โ ููุชุฑุฉ ุญุณุจ ุงููููุน (location)
- โ ููุชุฑุฉ ุญุณุจ ุงูุชุนููู (education)
- โ ููุชุฑุฉ ุญุณุจ ูุธููุฉ ูุญุฏุฏุฉ (jobId)

### 2. ุญุณุงุจ ุฏุฑุฌุฉ ุงูุชุทุงุจู ุงูุฐููุฉ
- ุญุณุงุจ ุชููุงุฆู ูุฏุฑุฌุฉ ุงูุชุทุงุจู (0-100%)
- ุฃุณุจุงุจ ูุงุถุญุฉ ููู ุชูุตูุฉ (explainable AI)
- ูุณุชูู ุงูุซูุฉ ูู ุงูุชูุตูุฉ (confidence)

### 3. ุชุฑุชูุจ ูุฑู
- ุชุฑุชูุจ ุญุณุจ ุฏุฑุฌุฉ ุงูุชุทุงุจู (score)
- ุชุฑุชูุจ ุญุณุจ ุณููุงุช ุงูุฎุจุฑุฉ (experience)
- ุชุฑุชูุจ ุญุณุจ ุงููุณุชูู ุงูุชุนูููู (education)

### 4. ุฅุญุตุงุกุงุช ุดุงููุฉ
- ุนุฏุฏ ุงููุฑุดุญูู ุงูููููููู
- ุนุฏุฏ ุงููุฑุดุญูู ุงููุทุงุจููู
- ูุชูุณุท ุฏุฑุฌุฉ ุงูุชุทุงุจู
- ูุทุงู ุงูุฎุจุฑุฉ (min, max, average)
- ุชูุฒูุน ุงููุณุชููุงุช ุงูุชุนููููุฉ

## API Endpoint

### GET /api/recommendations/candidates/filter

**Authentication**: ูุทููุจ (ููุดุฑูุงุช ููุท)

**Query Parameters**:

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `jobId` | string | No | ูุนุฑู ุงููุธููุฉ ููููุชุฑุฉ ุจูุงุกู ุนูููุง |
| `skills` | string/array | No | ุงูููุงุฑุงุช ุงููุทููุจุฉ |
| `minExperience` | number | No | ุงูุญุฏ ุงูุฃุฏูู ูุณููุงุช ุงูุฎุจุฑุฉ |
| `maxExperience` | number | No | ุงูุญุฏ ุงูุฃูุตู ูุณููุงุช ุงูุฎุจุฑุฉ |
| `location` | string | No | ุงููููุน ุงููุทููุจ (ูุฏููุฉ ุฃู ุฏููุฉ) |
| `education` | string | No | ุงููุณุชูู ุงูุชุนูููู ุงููุทููุจ |
| `minScore` | number | No | ุงูุญุฏ ุงูุฃุฏูู ูุฏุฑุฌุฉ ุงูุชุทุงุจู (default: 30) |
| `limit` | number | No | ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงููุฑุดุญูู (default: 50) |
| `sortBy` | string | No | ุชุฑุชูุจ ุงููุชุงุฆุฌ: 'score', 'experience', 'education' (default: 'score') |

**Response**:

```json
{
  "success": true,
  "message": "ุชู ุงูุนุซูุฑ ุนูู 15 ูุฑุดุญ ูุทุงุจู",
  "candidates": [
    {
      "candidate": {
        "_id": "507f1f77bcf86cd799439011",
        "firstName": "ุฃุญูุฏ",
        "lastName": "ูุญูุฏ",
        "email": "ahmed@example.com",
        "profileImage": "https://...",
        "city": "ุงููุงูุฑุฉ",
        "country": "ูุตุฑ",
        "specialization": "ุชุทููุฑ ุงูููุจ"
      },
      "matchScore": 85,
      "confidence": 0.9,
      "reasons": [
        {
          "type": "skills",
          "message": "ููุชูู 4 ูู 5 ููุงุฑุงุช ูุทููุจุฉ",
          "strength": "high",
          "details": {
            "matchedSkills": ["JavaScript", "React", "Node.js", "MongoDB"]
          }
        },
        {
          "type": "experience",
          "message": "5 ุณููุงุช ูู ุงูุฎุจุฑุฉ",
          "strength": "high",
          "details": {
            "years": 5
          }
        },
        {
          "type": "location",
          "message": "ูููุน ูุทุงุจู: ุงููุงูุฑุฉ, ูุตุฑ",
          "strength": "high",
          "details": {
            "city": "ุงููุงูุฑุฉ",
            "country": "ูุตุฑ"
          }
        }
      ],
      "features": {
        "totalExperience": 5,
        "skillsCount": 12,
        "education": "bachelor",
        "location": "ุงููุงูุฑุฉ, ูุตุฑ"
      }
    }
  ],
  "stats": {
    "totalEvaluated": 150,
    "totalMatched": 45,
    "totalReturned": 15,
    "averageScore": 72,
    "experienceRange": {
      "min": 2,
      "max": 10,
      "average": 5.3
    },
    "educationDistribution": {
      "bachelor": 8,
      "master": 5,
      "diploma": 2
    }
  },
  "filters": {
    "jobId": null,
    "skills": ["JavaScript", "React", "Node.js"],
    "minExperience": 2,
    "maxExperience": null,
    "location": "ุงููุงูุฑุฉ",
    "education": null,
    "minScore": 30,
    "sortBy": "score"
  },
  "timestamp": "2026-02-26T10:30:00.000Z"
}
```

## ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### 1. ููุชุฑุฉ ุญุณุจ ุงูููุงุฑุงุช ูุงูุฎุจุฑุฉ

```bash
GET /api/recommendations/candidates/filter?skills=JavaScript&skills=React&minExperience=2&maxExperience=5
```

### 2. ููุชุฑุฉ ุญุณุจ ุงููููุน ูุงูุชุนููู

```bash
GET /api/recommendations/candidates/filter?location=ุงููุงูุฑุฉ&education=bachelor&minScore=50
```

### 3. ููุชุฑุฉ ุจูุงุกู ุนูู ูุธููุฉ ูุญุฏุฏุฉ

```bash
GET /api/recommendations/candidates/filter?jobId=507f1f77bcf86cd799439011&limit=20&sortBy=experience
```

### 4. ููุชุฑุฉ ุดุงููุฉ

```bash
GET /api/recommendations/candidates/filter?skills=Python&skills=Django&minExperience=3&location=ูุตุฑ&education=bachelor&minScore=60&sortBy=score
```

## ุฎูุงุฑุฒููุฉ ุญุณุงุจ ุงูุฏุฑุฌุฉ

### ุนูุฏ ุชุญุฏูุฏ jobId:
ูุชู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ `calculateMatchScore` ูู `candidateRankingService` ุงูุชู ุชุญุณุจ:
- ุชุทุงุจู ุงูููุงุฑุงุช (40%)
- ุชุทุงุจู ุงูุฎุจุฑุฉ (30%)
- ุชุทุงุจู ุงูุชุนููู (20%)
- ุชุทุงุจู ุงููููุน (10%)

### ุนูุฏ ุนุฏู ุชุญุฏูุฏ jobId:
ูุชู ุญุณุงุจ ุงูุฏุฑุฌุฉ ุจูุงุกู ุนูู ุงููุนุงููุฑ ุงููุญุฏุฏุฉ:
- ุงูููุงุฑุงุช: 50% ูู ุงููุฒู
- ุงูุฎุจุฑุฉ: 30% ูู ุงููุฒู
- ุงููููุน: 20% ูู ุงููุฒู

## ุงููุณุชููุงุช ุงูุชุนููููุฉ ุงููุฏุนููุฉ

| Level | Score | Arabic |
|-------|-------|--------|
| phd | 5 | ุฏูุชูุฑุงู |
| doctorate | 5 | ุฏูุชูุฑุงู |
| master | 4 | ูุงุฌุณุชูุฑ |
| bachelor | 3 | ุจูุงููุฑููุณ |
| diploma | 2 | ุฏุจููู |
| high school | 1 | ุซุงูููุฉ ุนุงูุฉ |
| secondary | 1 | ุซุงูููุฉ ุนุงูุฉ |
| none | 0 | ูุง ููุฌุฏ |

## ูุนุงููุฑ ุงูููุชุฑุฉ

### ุงูููุงุฑุงุช (Skills)
- ูุจุญุซ ูู: `computerSkills`, `softwareSkills`, `otherSkills`
- ูุฏุนู ุงูุจุญุซ ุงูุฌุฒุฆู (partial matching)
- ุบูุฑ ุญุณุงุณ ูุญุงูุฉ ุงูุฃุญุฑู (case-insensitive)

### ุงูุฎุจุฑุฉ (Experience)
- ูุญุณุจ ุฅุฌูุงูู ุณููุงุช ุงูุฎุจุฑุฉ ูู `experienceList`
- ูุฏุนู ุงูุญุฏ ุงูุฃุฏูู ูุงูุฃูุตู
- ุฏูุฉ ุนุดุฑูุฉ (ูุซุงู: 2.5 ุณูุฉ)

### ุงููููุน (Location)
- ูุจุญุซ ูู: `city`, `country`
- ูุฏุนู ุงูุจุญุซ ุงูุฌุฒุฆู
- ุบูุฑ ุญุณุงุณ ูุญุงูุฉ ุงูุฃุญุฑู

### ุงูุชุนููู (Education)
- ููุงุฑู ุงููุณุชูู ุงูุชุนูููู ุงูุฃุนูู
- ูุฏุนู ุงูููุชุฑุฉ ุจุญุฏ ุฃุฏูู

## ุงูุชูุงูู ูุน ุงูุฃูุธูุฉ ุงูููุฌูุฏุฉ

### candidateRankingService
- `extractCandidateFeatures()` - ุงุณุชุฎุฑุงุฌ ููุฒุงุช ุงููุฑุดุญ
- `extractJobFeatures()` - ุงุณุชุฎุฑุงุฌ ููุฒุงุช ุงููุธููุฉ
- `calculateMatchScore()` - ุญุณุงุจ ุฏุฑุฌุฉ ุงูุชุทุงุจู

### JobPosting Model
- ุฌูุจ ุงููุธุงุฆู ููููุชุฑุฉ ุจูุงุกู ุนูููุง

### Individual Model (User)
- ุงูุจุญุซ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุฑุดุญูู
- ุงุณุชุฎุฏุงู indexes ููุฃุฏุงุก

## ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### Indexes ุงููุณุชุฎุฏูุฉ
```javascript
// ูู User Model
{
  'computerSkills.skill': 1,
  'softwareSkills.software': 1,
  'otherSkills': 1,
  'city': 1,
  'country': 1,
  'accountDisabled': 1
}
```

### ุงุณุชุฑุงุชูุฌูุฉ ุงูููุชุฑุฉ
1. ููุชุฑุฉ ุฃูููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (MongoDB query)
2. ุฌูุจ ุถุนู ุงูุนุฏุฏ ุงููุทููุจ ููุชุตููุฉ
3. ุชุทุจูู ููุชุฑุฉ ุฅุถุงููุฉ ูู ุงูููุฏ (experience, education)
4. ุญุณุงุจ ุฏุฑุฌุงุช ุงูุชุทุงุจู
5. ุชุฑุชูุจ ูุชุญุฏูุฏ ุงูุนุฏุฏ ุงูููุงุฆู

## ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ุญุงูุงุช ุงูุฎุทุฃ
- **400 Bad Request**: ูู ูุชู ุชุญุฏูุฏ ุฃู ูุนูุงุฑ ููููุชุฑุฉ
- **404 Not Found**: ุงููุธููุฉ ุงููุญุฏุฏุฉ ุบูุฑ ููุฌูุฏุฉ
- **500 Internal Server Error**: ุฎุทุฃ ูู ุงูุฎุงุฏู

### ุงูุงุณุชุฌุงุจุฉ ุนูุฏ ุนุฏู ูุฌูุฏ ูุชุงุฆุฌ
```json
{
  "success": true,
  "message": "ูู ูุชู ุงูุนุซูุฑ ุนูู ูุฑุดุญูู ูุทุงุจููู ูููุนุงููุฑ ุงููุญุฏุฏุฉ",
  "candidates": [],
  "total": 0,
  "filters": { ... }
}
```

## ุฃูุถู ุงูููุงุฑุณุงุช

### ููุดุฑูุงุช
โ **ุงูุนู**:
- ุญุฏุฏ ูุนุงููุฑ ูุงูุนูุฉ (ูุง ุชุจุงูุบ ูู ุงููุชุทูุจุงุช)
- ุงุณุชุฎุฏู `minScore` ููุงุณุจ (30-50 ููุจุฏุงูุฉ)
- ุฌุฑุจ ุชุฑุชูุจุงุช ูุฎุชููุฉ (`sortBy`)
- ุฑุงุฌุน ุงูุฅุญุตุงุกุงุช ูููู ุงูุณูู

โ **ูุง ุชูุนู**:
- ูุง ุชุญุฏุฏ ูุนุงููุฑ ุตุงุฑูุฉ ุฌุฏุงู (ูุฏ ูุง ุชุฌุฏ ูุชุงุฆุฌ)
- ูุง ุชุชุฌุงูู ุงููุฑุดุญูู ุฐูู ุงูุฏุฑุฌุงุช ุงููุชูุณุทุฉ
- ูุง ุชุนุชูุฏ ููุท ุนูู ุฏุฑุฌุฉ ุงูุชุทุงุจู

### ูููุทูุฑูู
โ **ุงูุนู**:
- ุงุณุชุฎุฏู pagination ูููุชุงุฆุฌ ุงููุจูุฑุฉ
- cache ุงููุชุงุฆุฌ ุงููุชูุฑุฑุฉ
- ุฑุงูุจ ุงูุฃุฏุงุก (response time)

โ **ูุง ุชูุนู**:
- ูุง ุชุทูุจ ุฃูุซุฑ ูู 100 ูุฑุดุญ ูู ูุฑุฉ ูุงุญุฏุฉ
- ูุง ุชุณุชุนูู ุจุฏูู ูุนุงููุฑ (ุณููุดู)

## ุงููููุงุช ุงููุนุฏูุฉ

### Backend
- โ `backend/src/controllers/recommendationController.js` - ุฅุถุงูุฉ `filterCandidatesIntelligently()`
- โ `backend/src/routes/recommendationRoutes.js` - ุฅุถุงูุฉ route ุฌุฏูุฏ
- โ `.kiro/specs/ai-recommendations/requirements.md` - ุชุญุฏูุซ ุญุงูุฉ ุงููุนูุงุฑ

### ุงูุชุจุนูุงุช
- `candidateRankingService.js` - ุงุณุชุฎุฏุงู ุงูุฏูุงู ุงูููุฌูุฏุฉ
- `JobPosting` Model - ุฌูุจ ุงููุธุงุฆู
- `Individual` Model - ุงูุจุญุซ ูู ุงููุฑุดุญูู

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ูุฏูู
```bash
# 1. ููุชุฑุฉ ุจุณูุทุฉ
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:5000/api/recommendations/candidates/filter?skills=JavaScript&minExperience=2"

# 2. ููุชุฑุฉ ูุชูุฏูุฉ
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:5000/api/recommendations/candidates/filter?jobId=JOB_ID&minScore=50&limit=20"

# 3. ููุชุฑุฉ ุญุณุจ ุงููููุน
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:5000/api/recommendations/candidates/filter?location=ุงููุงูุฑุฉ&education=bachelor"
```

### ุงุฎุชุจุงุฑ ุชููุงุฆู (ูุณุชูุจูุงู)
```javascript
// tests/candidateFiltering.test.js
describe('Smart Candidate Filtering', () => {
  it('should filter by skills', async () => {
    // Test implementation
  });
  
  it('should filter by experience range', async () => {
    // Test implementation
  });
  
  it('should filter by location', async () => {
    // Test implementation
  });
});
```

## ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### ูุตูุฑุฉ ุงููุฏู
- [ ] ุฅุถุงูุฉ ููุชุฑุฉ ุญุณุจ ุงูุฑุงุชุจ ุงููุชููุน
- [ ] ุฅุถุงูุฉ ููุชุฑุฉ ุญุณุจ ููุน ุงูุนูู (remote, onsite, hybrid)
- [ ] ุฅุถุงูุฉ ููุชุฑุฉ ุญุณุจ ุชููุฑ ุงููุฑุดุญ

### ูุชูุณุทุฉ ุงููุฏู
- [ ] ุญูุธ ูุนุงููุฑ ุงูููุชุฑุฉ ุงูููุถูุฉ
- [ ] ุฅุดุนุงุฑุงุช ุนูุฏ ุธููุฑ ูุฑุดุญูู ุฌุฏุฏ ูุทุงุจููู
- [ ] ุชุตุฏูุฑ ุงููุชุงุฆุฌ (CSV, PDF)

### ุทูููุฉ ุงููุฏู
- [ ] Machine Learning ูุชุญุณูู ุงูููุชุฑุฉ
- [ ] ุชุญููู ุชูุจุคู ููุฌุงุญ ุงูุชูุธูู
- [ ] ุชูุตูุงุช ุชููุงุฆูุฉ ููุนุงููุฑ ุงูููุชุฑุฉ

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ

### ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

**Q: ููุงุฐุง ูุง ุฃุญุตู ุนูู ูุชุงุฆุฌุ**
A: ุฌุฑุจ ุชุฎููู ุงููุนุงููุฑ (ููู `minScore`ุ ูุณูุน ูุทุงู ุงูุฎุจุฑุฉุ ุฃุฒู ุจุนุถ ุงูููุงุฑุงุช)

**Q: ููู ุฃุญุณู ุฌูุฏุฉ ุงููุชุงุฆุฌุ**
A: ุงุณุชุฎุฏู `jobId` ููููุชุฑุฉ ุจูุงุกู ุนูู ูุธููุฉ ูุญุฏุฏุฉุ ุฃู ุญุฏุฏ ุงูููุงุฑุงุช ุงูุฃุณุงุณูุฉ ููุท

**Q: ูุง ุงููุฑู ุจูู `sortBy=score` ู `sortBy=experience`ุ**
A: `score` ูุฑุชุจ ุญุณุจ ุงูุชุทุงุจู ุงูุฅุฌูุงููุ `experience` ูุฑุชุจ ุญุณุจ ุณููุงุช ุงูุฎุจุฑุฉ ููุท

### ุงูุชูุงุตู
- ๐ง Email: careerak.hr@gmail.com
- ๐ Documentation: `/docs/AI_RECOMMENDATIONS_SMART_FILTERING.md`

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2026-02-26  
**ุขุฎุฑ ุชุญุฏูุซ**: 2026-02-26  
**ุงูุญุงูุฉ**: โ ููุชูู ูููุนูู
