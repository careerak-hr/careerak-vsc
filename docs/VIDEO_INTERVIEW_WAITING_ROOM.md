# ูุธุงู ุบุฑูุฉ ุงูุงูุชุธุงุฑ ููููุงุจูุงุช - ุงูุชูุซูู ุงูุดุงูู

## ๐ ูุนูููุงุช ุงููุซููุฉ
- **ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2026-03-01
- **ุงูุญุงูุฉ**: โ ููุชูู ูููุนูู
- **ุงููุชุทูุจุงุช**: Requirements 4.1, 4.2, 4.3, 4.4, 4.5, 4.6

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุบุฑูุฉ ุงูุงูุชุธุงุฑ ูููุฑ ุชุฌุฑุจุฉ ุงุญุชุฑุงููุฉ ููููุงุจูุงุช ุนุจุฑ ุงูููุฏููุ ุญูุซ ูููู ูููุถูู ุงูุชุญูู ูู ูู ูุฏุฎู ุงูููุงุจูุฉ ููุชูุ ุจูููุง ููุชุธุฑ ุงููุฑุดุญูู ูู ุบุฑูุฉ ูููุตูุฉ ูุน ุฅููุงููุฉ ุงุฎุชุจุงุฑ ุฃุฌูุฒุชูู.

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### Backend Components

#### 1. WaitingRoom Model
```javascript
{
  roomId: String,              // ูุนุฑู ูุฑูุฏ ููุบุฑูุฉ
  interviewId: ObjectId,       // ุฑุจุท ุจุงูููุงุจูุฉ
  participants: [{
    userId: ObjectId,          // ุงููุดุงุฑู
    joinedAt: Date,            // ููุช ุงูุงูุถูุงู
    status: String,            // waiting | admitted | rejected
    admittedAt: Date,          // ููุช ุงููุจูู
    rejectedAt: Date           // ููุช ุงูุฑูุถ
  }],
  welcomeMessage: String       // ุฑุณุงูุฉ ุงูุชุฑุญูุจ
}
```

#### 2. WaitingRoomService
**ุงูููู**: `backend/src/services/waitingRoomService.js`

**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ**:
- `createWaitingRoom(interviewId, welcomeMessage)` - ุฅูุดุงุก ุบุฑูุฉ ุงูุชุธุงุฑ
- `addToWaitingRoom(interviewId, userId)` - ุฅุถุงูุฉ ูุดุงุฑู
- `admitParticipant(interviewId, userId, hostId)` - ูุจูู ูุดุงุฑู
- `rejectParticipant(interviewId, userId, hostId)` - ุฑูุถ ูุดุงุฑู
- `getWaitingList(interviewId, hostId)` - ูุงุฆูุฉ ุงูููุชุธุฑูู (ูููุถูู)
- `getWaitingRoomInfo(interviewId, userId)` - ูุนูููุงุช ุงูุบุฑูุฉ (ูููุดุงุฑู)
- `updateWelcomeMessage(interviewId, hostId, welcomeMessage)` - ุชุญุฏูุซ ุงูุฑุณุงูุฉ
- `removeFromWaitingRoom(interviewId, userId)` - ุฅุฒุงูุฉ ูุดุงุฑู
- `deleteWaitingRoom(interviewId)` - ุญุฐู ุงูุบุฑูุฉ

#### 3. WaitingRoomController
**ุงูููู**: `backend/src/controllers/waitingRoomController.js`

**Endpoints**:
- `POST /api/waiting-rooms` - ุฅูุดุงุก ุบุฑูุฉ
- `POST /api/waiting-rooms/:interviewId/join` - ุงูุงูุถูุงู
- `POST /api/waiting-rooms/:interviewId/admit/:userId` - ูุจูู
- `POST /api/waiting-rooms/:interviewId/reject/:userId` - ุฑูุถ
- `GET /api/waiting-rooms/:interviewId/list` - ูุงุฆูุฉ ุงูููุชุธุฑูู
- `GET /api/waiting-rooms/:interviewId/info` - ูุนูููุงุช ุงูุบุฑูุฉ
- `PUT /api/waiting-rooms/:interviewId/welcome-message` - ุชุญุฏูุซ ุงูุฑุณุงูุฉ
- `DELETE /api/waiting-rooms/:interviewId/leave` - ูุบุงุฏุฑุฉ
- `DELETE /api/waiting-rooms/:interviewId` - ุญุฐู

### Frontend Components

#### 1. WaitingRoom Component (ูููุดุงุฑููู)
**ุงูููู**: `frontend/src/components/VideoInterview/WaitingRoom.jsx`

**ุงูููุฒุงุช**:
- โ ุนุฑุถ ุฑุณุงูุฉ ุงูุชุฑุญูุจ
- โ ุนุฑุถ ูููุน ุงููุดุงุฑู ูู ุงูุทุงุจูุฑ
- โ ุนุฑุถ ููุช ุงูุงูุชุธุงุฑ (ูุญุฏูุซ ุชููุงุฆูุงู)
- โ ุนุฑุถ ุนุฏุฏ ุงูููุชุธุฑูู ุงูููู
- โ ูุนุงููุฉ ุงูููุฏูู ูุงูุตูุช
- โ ุงุฎุชุจุงุฑ ุงููุงููุฑุง ูุงููููุฑูููู
- โ ุชุจุฏูู ุชูุนูู/ุชุนุทูู ุงููุงููุฑุง ูุงููููุฑูููู
- โ ุฒุฑ ูุบุงุฏุฑุฉ ุงูุบุฑูุฉ
- โ ุชุญุฏูุซ ุชููุงุฆู ูู 5 ุซูุงูู
- โ ุฏุนู 3 ูุบุงุช (ar, en, fr)

#### 2. HostWaitingList Component (ูููุถูู)
**ุงูููู**: `frontend/src/components/VideoInterview/HostWaitingList.jsx`

**ุงูููุฒุงุช**:
- โ ุนุฑุถ ูุงุฆูุฉ ุงูููุชุธุฑูู ูุน ุงูุตูุฑ
- โ ุนุฑุถ ูููุน ูู ูุดุงุฑู
- โ ุนุฑุถ ููุช ุงูุชุธุงุฑ ูู ูุดุงุฑู
- โ ุฒุฑ ูุจูู ููู ูุดุงุฑู
- โ ุฒุฑ ุฑูุถ ููู ูุดุงุฑู
- โ ุชุนุฏูู ุฑุณุงูุฉ ุงูุชุฑุญูุจ
- โ ุชุญุฏูุซ ุชููุงุฆู ูู 3 ุซูุงูู
- โ ุฏุนู 3 ูุบุงุช (ar, en, fr)

---

## ๐ ุชุฏูู ุงูุนูู (Workflow)

### 1. ุฅูุดุงุก ุบุฑูุฉ ุงูุงูุชุธุงุฑ
```javascript
// ุนูุฏ ุฅูุดุงุก ููุงุจูุฉ ุฌุฏูุฏุฉ
const waitingRoom = await waitingRoomService.createWaitingRoom(
  interviewId,
  'ูุฑุญุจุงู ุจู! ูุฑุฌู ุงูุงูุชุธุงุฑ ุญุชู ููุจูู ุงููุถูู.'
);
```

### 2. ุงูุถูุงู ูุดุงุฑู
```javascript
// ุงููุดุงุฑู ููุถู ูุบุฑูุฉ ุงูุงูุชุธุงุฑ
const result = await waitingRoomService.addToWaitingRoom(interviewId, userId);
```

### 3. ุงููุถูู ูุฑู ุงููุงุฆูุฉ
```javascript
// ุงููุถูู ูุญุตู ุนูู ูุงุฆูุฉ ุงูููุชุธุฑูู
const waitingList = await waitingRoomService.getWaitingList(interviewId, hostId);
```

### 4. ูุจูู ูุดุงุฑู
```javascript
// ุงููุถูู ููุจู ูุดุงุฑู
const result = await waitingRoomService.admitParticipant(
  interviewId,
  userId,
  hostId
);
```

### 5. ุงููุดุงุฑู ููุถู ููููุงุจูุฉ
```javascript
// ุจุนุฏ ุงููุจููุ ุงููุดุงุฑู ููุชูู ููููุงุจูุฉ ุชููุงุฆูุงู
if (waitingInfo.status === 'admitted') {
  onAdmitted();
}
```

---

## ๐ API Examples

### ุฅูุดุงุก ุบุฑูุฉ ุงูุชุธุงุฑ
```bash
POST /api/waiting-rooms
Authorization: Bearer <token>
Content-Type: application/json

{
  "interviewId": "65f1234567890abcdef12345",
  "welcomeMessage": "ูุฑุญุจุงู ุจู ูู ููุงุจูุฉ ุดุฑูุฉ XYZ"
}
```

**Response**:
```json
{
  "success": true,
  "data": {
    "roomId": "waiting-uuid-here",
    "interviewId": "65f1234567890abcdef12345",
    "welcomeMessage": "ูุฑุญุจุงู ุจู ูู ููุงุจูุฉ ุดุฑูุฉ XYZ",
    "participants": []
  }
}
```

### ุงูุงูุถูุงู ูุบุฑูุฉ ุงูุงูุชุธุงุฑ
```bash
POST /api/waiting-rooms/65f1234567890abcdef12345/join
Authorization: Bearer <token>
```

**Response**:
```json
{
  "success": true,
  "data": {
    "roomId": "waiting-uuid-here",
    "participants": [
      {
        "userId": "65f9876543210fedcba98765",
        "joinedAt": "2026-03-01T10:30:00.000Z",
        "status": "waiting"
      }
    ]
  },
  "alreadyInRoom": false
}
```

### ูุจูู ูุดุงุฑู
```bash
POST /api/waiting-rooms/65f1234567890abcdef12345/admit/65f9876543210fedcba98765
Authorization: Bearer <token>
```

**Response**:
```json
{
  "success": true,
  "data": {
    "waitingRoom": { ... },
    "interview": { ... },
    "participant": {
      "userId": "65f9876543210fedcba98765",
      "status": "admitted",
      "admittedAt": "2026-03-01T10:35:00.000Z"
    }
  }
}
```

### ุงูุญุตูู ุนูู ูุนูููุงุช ุงูุบุฑูุฉ (ูููุดุงุฑู)
```bash
GET /api/waiting-rooms/65f1234567890abcdef12345/info
Authorization: Bearer <token>
```

**Response**:
```json
{
  "success": true,
  "data": {
    "roomId": "waiting-uuid-here",
    "welcomeMessage": "ูุฑุญุจุงู ุจู ูู ููุงุจูุฉ ุดุฑูุฉ XYZ",
    "status": "waiting",
    "waitingTime": 300,
    "position": 2,
    "totalWaiting": 5
  }
}
```

---

## ๐จ UI/UX Features

### ูููุดุงุฑููู (WaitingRoom)
1. **ุฑุณุงูุฉ ุงูุชุฑุญูุจ**: ุฑุณุงูุฉ ูุฎุตุตุฉ ูู ุงููุถูู
2. **ูุนูููุงุช ุงูุงูุชุธุงุฑ**:
   - ูููุนู ูู ุงูุทุงุจูุฑ (1ุ 2ุ 3...)
   - ููุช ุงูุงูุชุธุงุฑ (ูุญุฏูุซ ุชููุงุฆูุงู)
   - ุนุฏุฏ ุงูููุชุธุฑูู ุงูููู
3. **ุงุฎุชุจุงุฑ ุงูุฃุฌูุฒุฉ**:
   - ูุนุงููุฉ ุงูููุฏูู
   - ุงุฎุชุจุงุฑ ุงููููุฑูููู
   - ุชุจุฏูู ุชูุนูู/ุชุนุทูู
4. **ูุคุดุฑ ุงูุงูุชุธุงุฑ**: ุฑุณูู ูุชุญุฑูุฉ pulse
5. **ุฒุฑ ุงููุบุงุฏุฑุฉ**: ููุฎุฑูุฌ ูู ุงูุบุฑูุฉ

### ูููุถูู (HostWaitingList)
1. **ูุงุฆูุฉ ุงูููุชุธุฑูู**:
   - ุตูุฑุฉ ุงููุดุงุฑู
   - ุงูุงุณู ูุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ูููุน ูู ุงูุทุงุจูุฑ
   - ููุช ุงูุงูุชุธุงุฑ
2. **ุฃุฒุฑุงุฑ ุงูุชุญูู**:
   - ูุจูู (ุฃุฎุถุฑ)
   - ุฑูุถ (ุฃุญูุฑ)
3. **ุฑุณุงูุฉ ุงูุชุฑุญูุจ**:
   - ุนุฑุถ ุงูุฑุณุงูุฉ ุงูุญุงููุฉ
   - ุชุนุฏูู ุงูุฑุณุงูุฉ
   - ุญูุธ ุงูุชุบููุฑุงุช
4. **ุนุฏุงุฏ ุงูููุชุธุฑูู**: badge ูุนุฑุถ ุงูุนุฏุฏ

---

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- โ ุฌููุน endpoints ุชุญุชุงุฌ authentication
- โ ููุท ุงููุถูู ููููู:
  - ุฑุคูุฉ ูุงุฆูุฉ ุงูููุชุธุฑูู
  - ูุจูู/ุฑูุถ ุงููุดุงุฑููู
  - ุชุนุฏูู ุฑุณุงูุฉ ุงูุชุฑุญูุจ
- โ ุงููุดุงุฑููู ูููููู ููุท:
  - ุฑุคูุฉ ูุนูููุงุชูู ุงูุฎุงุตุฉ
  - ูุบุงุฏุฑุฉ ุงูุบุฑูุฉ

### ุงูุชุญูู ูู ุงููููุฉ
```javascript
// ูู WaitingRoomService
if (interview.hostId.toString() !== hostId.toString()) {
  throw new Error('Only host can admit participants');
}
```

---

## โก ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### ุงูุชุญุฏูุซ ุงูุชููุงุฆู
- **ูููุดุงุฑููู**: ูู 5 ุซูุงูู
- **ูููุถูู**: ูู 3 ุซูุงูู

### ุชุญุณููุงุช ุงูุฃุฏุงุก
- โ ุงุณุชุฎุฏุงู `setInterval` ููุชุญุฏูุซ ุงูุชููุงุฆู
- โ ุชูุธูู `interval` ุนูุฏ unmount
- โ ุฅููุงู video stream ุนูุฏ ุงููุบุงุฏุฑุฉ
- โ Lazy loading ููุตูุฑ
- โ Debouncing ูุชุนุฏูู ุงูุฑุณุงูุฉ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ Backend
```bash
cd backend
npm test -- waitingRoom.test.js
```

### ุงุฎุชุจุงุฑ Frontend
```bash
cd frontend
npm test -- WaitingRoom.test.jsx
npm test -- HostWaitingList.test.jsx
```

### ุงุฎุชุจุงุฑ ูุฏูู
1. ุฅูุดุงุก ููุงุจูุฉ ุฌุฏูุฏุฉ
2. ูุชุญ ุงูููุงุจูุฉ ููุถูู
3. ูุชุญ ุงูููุงุจูุฉ ููุดุงุฑู (ูู ูุงูุฐุฉ ุฃุฎุฑู)
4. ุงูุชุญูู ูู ุธููุฑ ุงููุดุงุฑู ูู ูุงุฆูุฉ ุงูููุชุธุฑูู
5. ูุจูู ุงููุดุงุฑู
6. ุงูุชุญูู ูู ุงูุชูุงู ุงููุดุงุฑู ููููุงุจูุฉ

---

## ๐ฑ ุงูุชุตููู ุงููุชุฌุงูุจ

### Breakpoints
- **Desktop**: > 1024px
- **Tablet**: 768px - 1024px
- **Mobile**: < 768px

### ุชุญุณููุงุช Mobile
- โ ุชุฎุทูุท ุนููุฏู ููุจุทุงูุงุช
- โ ุฃุฒุฑุงุฑ ุฃูุจุฑ ูููุณ
- โ ูุต ุฃูุจุฑ ูููุฑุงุกุฉ
- โ ุชุญุณูู ูุนุงููุฉ ุงูููุฏูู

---

## ๐ ุฏุนู ุงููุบุงุช

### ุงููุบุงุช ุงููุฏุนููุฉ
- โ ุงูุนุฑุจูุฉ (ar)
- โ ุงูุฅูุฌููุฒูุฉ (en)
- โ ุงููุฑูุณูุฉ (fr)

### ุฅุถุงูุฉ ูุบุฉ ุฌุฏูุฏุฉ
```javascript
const translations = {
  ar: { ... },
  en: { ... },
  fr: { ... },
  es: {  // ุฅุณุจุงููุฉ
    title: 'Sala de espera',
    waiting: 'Esperando...',
    // ...
  }
};
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดุงุฑู ูุง ูุธูุฑ ูู ุงููุงุฆูุฉ
**ุงูุณุจุจ**: ูุฏ ูููู ุงููุดุงุฑู ูู ููุถู ุจุนุฏ
**ุงูุญู**: ุชุญูู ูู ุงุณุชุฏุนุงุก `addToWaitingRoom`

### ุงูููุฏูู ูุง ูุนูู
**ุงูุณุจุจ**: ุนุฏู ููุญ ุฅุฐู ุงููุงููุฑุง/ุงููููุฑูููู
**ุงูุญู**: ุชุญูู ูู ุฃุฐููุงุช ุงููุชุตูุญ

### ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูุง ูุนูู
**ุงูุณุจุจ**: `interval` ูู ูุชู ุฅุนุฏุงุฏู ุจุดูู ุตุญูุญ
**ุงูุญู**: ุชุญูู ูู `useEffect` ู `cleanup`

---

## ๐ ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### ุงููุฑุญูุฉ ุงููุงุฏูุฉ
- [ ] ุฅุดุนุงุฑุงุช ููุฑูุฉ ุนูุฏ ูุจูู/ุฑูุถ (Socket.IO)
- [ ] ุชูุฏูุฑ ููุช ุงูุงูุชุธุงุฑ ุงููุชููุน
- [ ] ุฅููุงููุฉ ุฅุฑุณุงู ุฑุณุงูุฉ ููููุชุธุฑูู
- [ ] ุณุฌู ุงูููุชุธุฑูู (ูู ุฏุฎู ููุชู)
- [ ] ุฅุญุตุงุฆูุงุช ููุช ุงูุงูุชุธุงุฑ

### ุชุญุณููุงุช ุงูุฃุฏุงุก
- [ ] WebSocket ุจุฏูุงู ูู polling
- [ ] Caching ููุงุฆูุฉ ุงูููุชุธุฑูู
- [ ] Pagination ููููุงุฆู ุงูุทูููุฉ
- [ ] Compression ููููุฏูู

---

## ๐ ุงููุฑุงุฌุน

- [WebRTC API](https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API)
- [MediaDevices API](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices)
- [Socket.IO Documentation](https://socket.io/docs/)

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2026-03-01  
**ุขุฎุฑ ุชุญุฏูุซ**: 2026-03-01  
**ุงูุญุงูุฉ**: โ ููุชูู ูููุนูู
