{"ast":null,"code":"import React,{useEffect,useState,useRef}from'react';import{useNavigate}from'react-router-dom';import{discoverBestServer}from'../services/api';import{useAuth}from'../context/AuthContext';import{App}from'@capacitor/app';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const entryTranslations={ar:{slogan:\"مستقبل الموارد البشرية\"},en:{slogan:\"The Future of HR\"},fr:{slogan:\"L'avenir des RH\"}};export default function EntryPage(){const[phase,setPhase]=useState(0);// 0 = سكون، 1 = ظهور، 2 = تفاعل، 3 = خروج\nconst navigate=useNavigate();const{audioEnabled,language}=useAuth();const t=entryTranslations[language]||entryTranslations.ar;const audioRef=useRef(null);const isMounted=useRef(true);useEffect(()=>{isMounted.current=true;// 1. اكتشاف السيرفر في الخلفية\nconst initServer=async()=>{try{await discoverBestServer();}catch(error){console.log(\"Server initializing...\");}};initServer();const SYSTEM_DELAY=1000;// 2. سلسلة المؤقتات (تعمل مرة واحدة فقط عند التحميل)\nconst timers=[setTimeout(()=>{if(isMounted.current){setPhase(1);if(audioEnabled&&!audioRef.current){audioRef.current=new Audio('/intro.mp3');audioRef.current.volume=0.6;audioRef.current.play().catch(()=>{});}}},SYSTEM_DELAY),setTimeout(()=>{if(isMounted.current)setPhase(2);},SYSTEM_DELAY+1500),setTimeout(()=>{if(isMounted.current)setPhase(3);},SYSTEM_DELAY+7000),setTimeout(()=>{if(audioRef.current){audioRef.current.pause();audioRef.current=null;}if(isMounted.current)navigate('/login',{replace:true});},SYSTEM_DELAY+9000)];// إدارة حالة التطبيق (إيقاف/تشغيل الصوت عند الخروج من التطبيق)\nconst handleAppState=state=>{if(audioRef.current){if(state.isActive&&audioEnabled){audioRef.current.play().catch(()=>{});}else{audioRef.current.pause();}}};const listener=App.addListener('appStateChange',handleAppState);return()=>{isMounted.current=false;timers.forEach(clearTimeout);if(audioRef.current){audioRef.current.pause();audioRef.current=null;}listener.then(l=>l.remove());};// تم حذف [phase] من هنا لحل مشكلة التكرار والجمود\n},[navigate,audioEnabled]);return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-[10000] flex flex-col items-center justify-center overflow-hidden bg-[#E3DAD0] select-none\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-b from-white/20 to-transparent transition-opacity duration-1000 \".concat(phase>=1?'opacity-100':'opacity-0')}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex flex-col items-center justify-center w-full h-full max-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute w-[150vw] h-[150vw] max-w-[800px] max-h-[800px] bg-[#1A365D] opacity-[0.04] rounded-full transition-transform duration-[7000ms] ease-out \".concat(phase>=2?'scale-150':'scale-0')}),/*#__PURE__*/_jsx(\"div\",{className:\"relative transition-all duration-1000 ease-out transform \".concat(phase===0?'scale-75 opacity-0':phase===1?'scale-110 opacity-100':phase===2?'scale-100 opacity-100':'scale-90 opacity-0'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative p-2 md:p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 border-2 border-[#1A365D]/10 rounded-full animate-spin-slow\"}),/*#__PURE__*/_jsx(\"img\",{src:\"/logo.jpg\",alt:\"Logo\",className:\"relative h-32 w-32 md:h-48 md:w-48 rounded-full border-[4px] border-[#1A365D] shadow-2xl object-cover\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 md:mt-12 text-center transition-all duration-1000 delay-300 transform \".concat(phase>=1&&phase<3?'translate-y-0 opacity-100':'translate-y-10 opacity-0'),children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl md:text-7xl font-black text-[#1A365D] tracking-tight mb-4 drop-shadow-sm italic\",style:{fontFamily:'serif'},children:\"Careerak\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-[1.5px] w-10 md:w-16 bg-[#1A365D]/20\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[#1A365D]/80 font-black text-[13px] md:text-lg uppercase tracking-[0.2em] md:tracking-[0.3em]\",children:t.slogan}),/*#__PURE__*/_jsx(\"div\",{className:\"h-[1.5px] w-10 md:w-16 bg-[#1A365D]/20\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-10 md:bottom-20 w-48 md:w-64 h-[2px] md:h-[3px] bg-[#1A365D]/10 rounded-full overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-[#1A365D] transition-all ease-linear\",style:{width:phase>=1?'100%':'0%',transitionDuration:phase>=1?'8500ms':'0ms'}})})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","useNavigate","discoverBestServer","useAuth","App","jsx","_jsx","jsxs","_jsxs","entryTranslations","ar","slogan","en","fr","EntryPage","phase","setPhase","navigate","audioEnabled","language","t","audioRef","isMounted","current","initServer","error","console","log","SYSTEM_DELAY","timers","setTimeout","Audio","volume","play","catch","pause","replace","handleAppState","state","isActive","listener","addListener","forEach","clearTimeout","then","l","remove","className","children","concat","src","alt","style","fontFamily","width","transitionDuration"],"sources":["D:/Careerak/Careerak-vsc/frontend/src/pages/01_EntryPage.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { discoverBestServer } from '../services/api';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { App } from '@capacitor/app';\r\n\r\nconst entryTranslations = {\r\n  ar: { slogan: \"مستقبل الموارد البشرية\" },\r\n  en: { slogan: \"The Future of HR\" },\r\n  fr: { slogan: \"L'avenir des RH\" }\r\n};\r\n\r\nexport default function EntryPage() {\r\n  const [phase, setPhase] = useState(0); // 0 = سكون، 1 = ظهور، 2 = تفاعل، 3 = خروج\r\n  const navigate = useNavigate();\r\n  const { audioEnabled, language } = useAuth();\r\n  const t = entryTranslations[language] || entryTranslations.ar;\r\n\r\n  const audioRef = useRef(null);\r\n  const isMounted = useRef(true);\r\n\r\n  useEffect(() => {\r\n    isMounted.current = true;\r\n\r\n    // 1. اكتشاف السيرفر في الخلفية\r\n    const initServer = async () => {\r\n      try {\r\n        await discoverBestServer();\r\n      } catch (error) {\r\n        console.log(\"Server initializing...\");\r\n      }\r\n    };\r\n    initServer();\r\n\r\n    const SYSTEM_DELAY = 1000;\r\n\r\n    // 2. سلسلة المؤقتات (تعمل مرة واحدة فقط عند التحميل)\r\n    const timers = [\r\n      setTimeout(() => {\r\n        if (isMounted.current) {\r\n          setPhase(1);\r\n          if (audioEnabled && !audioRef.current) {\r\n            audioRef.current = new Audio('/intro.mp3');\r\n            audioRef.current.volume = 0.6;\r\n            audioRef.current.play().catch(() => {});\r\n          }\r\n        }\r\n      }, SYSTEM_DELAY),\r\n\r\n      setTimeout(() => {\r\n        if (isMounted.current) setPhase(2);\r\n      }, SYSTEM_DELAY + 1500),\r\n\r\n      setTimeout(() => {\r\n        if (isMounted.current) setPhase(3);\r\n      }, SYSTEM_DELAY + 7000),\r\n\r\n      setTimeout(() => {\r\n        if (audioRef.current) {\r\n          audioRef.current.pause();\r\n          audioRef.current = null;\r\n        }\r\n        if (isMounted.current) navigate('/login', { replace: true });\r\n      }, SYSTEM_DELAY + 9000)\r\n    ];\r\n\r\n    // إدارة حالة التطبيق (إيقاف/تشغيل الصوت عند الخروج من التطبيق)\r\n    const handleAppState = (state) => {\r\n      if (audioRef.current) {\r\n        if (state.isActive && audioEnabled) {\r\n          audioRef.current.play().catch(() => {});\r\n        } else {\r\n          audioRef.current.pause();\r\n        }\r\n      }\r\n    };\r\n\r\n    const listener = App.addListener('appStateChange', handleAppState);\r\n\r\n    return () => {\r\n      isMounted.current = false;\r\n      timers.forEach(clearTimeout);\r\n      if (audioRef.current) {\r\n        audioRef.current.pause();\r\n        audioRef.current = null;\r\n      }\r\n      listener.then(l => l.remove());\r\n    };\r\n    // تم حذف [phase] من هنا لحل مشكلة التكرار والجمود\r\n  }, [navigate, audioEnabled]);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[10000] flex flex-col items-center justify-center overflow-hidden bg-[#E3DAD0] select-none\">\r\n      <div className={`absolute inset-0 bg-gradient-to-b from-white/20 to-transparent transition-opacity duration-1000 ${phase >= 1 ? 'opacity-100' : 'opacity-0'}`}></div>\r\n\r\n      <div className=\"relative flex flex-col items-center justify-center w-full h-full max-h-screen\">\r\n        <div className=\"relative flex items-center justify-center\">\r\n          <div className={`absolute w-[150vw] h-[150vw] max-w-[800px] max-h-[800px] bg-[#1A365D] opacity-[0.04] rounded-full transition-transform duration-[7000ms] ease-out ${phase >= 2 ? 'scale-150' : 'scale-0'}`}></div>\r\n\r\n          <div className={`relative transition-all duration-1000 ease-out transform ${\r\n            phase === 0 ? 'scale-75 opacity-0' :\r\n            phase === 1 ? 'scale-110 opacity-100' :\r\n            phase === 2 ? 'scale-100 opacity-100' :\r\n            'scale-90 opacity-0'\r\n          }`}>\r\n            <div className=\"relative p-2 md:p-4\">\r\n              <div className=\"absolute inset-0 border-2 border-[#1A365D]/10 rounded-full animate-spin-slow\"></div>\r\n              <img src=\"/logo.jpg\" alt=\"Logo\" className=\"relative h-32 w-32 md:h-48 md:w-48 rounded-full border-[4px] border-[#1A365D] shadow-2xl object-cover\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className={`mt-6 md:mt-12 text-center transition-all duration-1000 delay-300 transform ${phase >= 1 && phase < 3 ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'}`}>\r\n          <h1 className=\"text-5xl md:text-7xl font-black text-[#1A365D] tracking-tight mb-4 drop-shadow-sm italic\" style={{ fontFamily: 'serif' }}>Careerak</h1>\r\n          <div className=\"flex items-center justify-center gap-4\">\r\n            <div className=\"h-[1.5px] w-10 md:w-16 bg-[#1A365D]/20\"></div>\r\n            <p className=\"text-[#1A365D]/80 font-black text-[13px] md:text-lg uppercase tracking-[0.2em] md:tracking-[0.3em]\">{t.slogan}</p>\r\n            <div className=\"h-[1.5px] w-10 md:w-16 bg-[#1A365D]/20\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"absolute bottom-10 md:bottom-20 w-48 md:w-64 h-[2px] md:h-[3px] bg-[#1A365D]/10 rounded-full overflow-hidden\">\r\n        <div\r\n          className=\"h-full bg-[#1A365D] transition-all ease-linear\"\r\n          style={{\r\n            width: phase >= 1 ? '100%' : '0%',\r\n            transitionDuration: phase >= 1 ? '8500ms' : '0ms'\r\n          }}\r\n        ></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}