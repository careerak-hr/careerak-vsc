{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState,useRef}from\"react\";import{Preferences}from\"@capacitor/preferences\";import{App}from\"@capacitor/app\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[language,setLanguage]=useState(null);const[audioEnabled,setAudioEnabled]=useState(null);const[loading,setLoading]=useState(true);const audioRef=useRef(null);useEffect(()=>{const loadPrefs=async()=>{const{value:lang}=await Preferences.get({key:\"lang\"});const{value:audio}=await Preferences.get({key:\"audio_enabled\"});if(lang){setLanguage(lang);document.documentElement.lang=lang;document.documentElement.dir=lang===\"ar\"?\"rtl\":\"ltr\";}const isAudioEnabled=audio===null?true:audio===\"true\";setAudioEnabled(isAudioEnabled);setLoading(false);};loadPrefs();},[]);// إدارة الموسيقى العالمية\nuseEffect(()=>{if(audioEnabled&&!loading){if(!audioRef.current){audioRef.current=new Audio('/Music.mp3');audioRef.current.loop=true;audioRef.current.volume=0.4;}audioRef.current.play().catch(e=>console.log(\"Audio play failed:\",e));}else if(audioRef.current){audioRef.current.pause();}// مراقبة حالة التطبيق (Home, Lock, Background)\nconst handleAppState=state=>{if(!audioRef.current||!audioEnabled)return;if(state.isActive){audioRef.current.play().catch(()=>{});}else{audioRef.current.pause();}};const listener=App.addListener('appStateChange',handleAppState);return()=>{listener.then(l=>l.remove());};},[audioEnabled,loading]);const changeLanguage=async lang=>{await Preferences.set({key:\"lang\",value:lang});setLanguage(lang);document.documentElement.lang=lang;document.documentElement.dir=lang===\"ar\"?\"rtl\":\"ltr\";};const setAudio=async enabled=>{await Preferences.set({key:\"audio_enabled\",value:enabled?\"true\":\"false\"});setAudioEnabled(enabled);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{language,audioEnabled,loading,changeLanguage,setAudio},children:children});};export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useRef","Preferences","App","jsx","_jsx","AuthContext","AuthProvider","_ref","children","language","setLanguage","audioEnabled","setAudioEnabled","loading","setLoading","audioRef","loadPrefs","value","lang","get","key","audio","document","documentElement","dir","isAudioEnabled","current","Audio","loop","volume","play","catch","e","console","log","pause","handleAppState","state","isActive","listener","addListener","then","l","remove","changeLanguage","set","setAudio","enabled","Provider","useAuth"],"sources":["D:/Careerak/Careerak-vsc/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, useRef } from \"react\";\r\nimport { Preferences } from \"@capacitor/preferences\";\r\nimport { App } from \"@capacitor/app\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [language, setLanguage] = useState(null);\r\n  const [audioEnabled, setAudioEnabled] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const audioRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const loadPrefs = async () => {\r\n      const { value: lang } = await Preferences.get({ key: \"lang\" });\r\n      const { value: audio } = await Preferences.get({ key: \"audio_enabled\" });\r\n\r\n      if (lang) {\r\n        setLanguage(lang);\r\n        document.documentElement.lang = lang;\r\n        document.documentElement.dir = lang === \"ar\" ? \"rtl\" : \"ltr\";\r\n      }\r\n\r\n      const isAudioEnabled = audio === null ? true : audio === \"true\";\r\n      setAudioEnabled(isAudioEnabled);\r\n      setLoading(false);\r\n    };\r\n\r\n    loadPrefs();\r\n  }, []);\r\n\r\n  // إدارة الموسيقى العالمية\r\n  useEffect(() => {\r\n    if (audioEnabled && !loading) {\r\n      if (!audioRef.current) {\r\n        audioRef.current = new Audio('/Music.mp3');\r\n        audioRef.current.loop = true;\r\n        audioRef.current.volume = 0.4;\r\n      }\r\n      audioRef.current.play().catch(e => console.log(\"Audio play failed:\", e));\r\n    } else if (audioRef.current) {\r\n      audioRef.current.pause();\r\n    }\r\n\r\n    // مراقبة حالة التطبيق (Home, Lock, Background)\r\n    const handleAppState = (state) => {\r\n      if (!audioRef.current || !audioEnabled) return;\r\n      if (state.isActive) {\r\n        audioRef.current.play().catch(() => {});\r\n      } else {\r\n        audioRef.current.pause();\r\n      }\r\n    };\r\n\r\n    const listener = App.addListener('appStateChange', handleAppState);\r\n    \r\n    return () => {\r\n      listener.then(l => l.remove());\r\n    };\r\n  }, [audioEnabled, loading]);\r\n\r\n  const changeLanguage = async (lang) => {\r\n    await Preferences.set({ key: \"lang\", value: lang });\r\n    setLanguage(lang);\r\n    document.documentElement.lang = lang;\r\n    document.documentElement.dir = lang === \"ar\" ? \"rtl\" : \"ltr\";\r\n  };\r\n\r\n  const setAudio = async (enabled) => {\r\n    await Preferences.set({\r\n      key: \"audio_enabled\",\r\n      value: enabled ? \"true\" : \"false\",\r\n    });\r\n    setAudioEnabled(enabled);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        language,\r\n        audioEnabled,\r\n        loading,\r\n        changeLanguage,\r\n        setAudio,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}